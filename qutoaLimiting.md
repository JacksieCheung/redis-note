漏斗限流是常用的限流方法。

redis通过redis-cell来使用这种方法。

redis-cell只有一个指令。cl.throttle

```
127.0.0.1:6379> cl.throttle laoqian:reply 15 30 60 1
1) (integer) 0
2) (integer) 16
3) (integer) 15
4) (integer) -1
5) (integer) 2
```

laoqian是key 15是漏斗容量 30 60表示 30/60s 是速率 1是可选参数，默认也是1

返回参数 0 表示允许，1表示拒绝。16表示漏斗容量 15表示剩余空间，-1表示如果被拒绝需要多长时间再试，单位为秒。2表示多长时间漏斗完全空出来,单位秒。

执行限流指令如果被拒绝，就要丢弃或者重试。直接取返回结果数组的第四个值进行sleep。也可以用异步定时任务。


